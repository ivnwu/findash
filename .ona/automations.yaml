tasks:
  install-deps:
    name: Install dependencies
    description: Install Python dependencies from requirements.txt.
    command: |
      pip install -r requirements.txt
    triggeredBy:
      - postDevcontainerStart

  update-fx-rates:
    name: Update FX rates
    description: Fetch latest FX rates from yfinance and store in Supabase.
    command: |
      python update_fx_rates.py
    triggeredBy:
      - manual
    dependsOn:
      - install-deps

  update-prices:
    name: Update asset prices
    description: Fetch daily close prices from yfinance and store in Supabase.
    command: |
      python update_prices.py
    triggeredBy:
      - manual
    dependsOn:
      - install-deps

  update-earnings:
    name: Update earnings data
    description: Fetch latest earnings data and AI summaries for tracked symbols.
    command: |
      python update_earnings.py
    triggeredBy:
      - manual
    dependsOn:
      - install-deps

services:
  streamlit-app:
    name: Streamlit Dashboard
    description: Runs the findash Streamlit app on port 8501.
    commands:
      start: |
        gitpod env port open 8501 --name "Streamlit Dashboard" -w
        streamlit run app.py --server.port 8501 --server.headless true --server.address 0.0.0.0
      ready: |
        curl -f http://localhost:8501/_stcore/health
